{"version":3,"file":"stack-context.esm.js","sources":["../../src/internal/stack-context.ts"],"sourcesContent":["import {\n  inject,\n  provide,\n  watchEffect,\n\n  // Types\n  InjectionKey,\n  Ref,\n} from 'vue'\n\ntype OnUpdate = (message: StackMessage, element: HTMLElement) => void\n\nlet StackContext = Symbol('StackContext') as InjectionKey<OnUpdate>\n\nexport enum StackMessage {\n  AddElement,\n  RemoveElement,\n}\n\nexport function useStackContext() {\n  return inject(StackContext, () => {})\n}\n\nexport function useElemenStack(element: Ref<HTMLElement | null> | null) {\n  let notify = useStackContext()\n\n  watchEffect(onInvalidate => {\n    let domElement = element?.value\n    if (!domElement) return\n\n    notify(StackMessage.AddElement, domElement)\n    onInvalidate(() => notify(StackMessage.RemoveElement, domElement!))\n  })\n}\n\nexport function useStackProvider(onUpdate?: OnUpdate) {\n  let parentUpdate = useStackContext()\n\n  function notify(...args: Parameters<OnUpdate>) {\n    // Notify our layer\n    onUpdate?.(...args)\n\n    // Notify the parent\n    parentUpdate(...args)\n  }\n\n  provide(StackContext, notify)\n}\n"],"names":["StackContext","Symbol","StackMessage","useStackContext","inject","useElemenStack","element","notify","watchEffect","onInvalidate","domElement","value","AddElement","RemoveElement","useStackProvider","onUpdate","parentUpdate","args","provide"],"mappings":";;AAYA,IAAIA,YAAY,gBAAGC,MAAM,CAAC,cAAD,CAAzB;IAEYC;;AAAZ,WAAYA;AACVA,EAAAA,4CAAA,eAAA;AACAA,EAAAA,+CAAA,kBAAA;AACD,CAHD,EAAYA,YAAY,KAAZA,YAAY,KAAA,CAAxB;;SAKgBC;AACd,SAAOC,MAAM,CAACJ,YAAD,EAAe,cAAf,CAAb;AACD;SAEeK,eAAeC;AAC7B,MAAIC,MAAM,GAAGJ,eAAe,EAA5B;AAEAK,EAAAA,WAAW,CAAC,UAAAC,YAAY;AACtB,QAAIC,UAAU,GAAGJ,OAAH,oBAAGA,OAAO,CAAEK,KAA1B;AACA,QAAI,CAACD,UAAL,EAAiB;AAEjBH,IAAAA,MAAM,CAACL,YAAY,CAACU,UAAd,EAA0BF,UAA1B,CAAN;AACAD,IAAAA,YAAY,CAAC;AAAA,aAAMF,MAAM,CAACL,YAAY,CAACW,aAAd,EAA6BH,UAA7B,CAAZ;AAAA,KAAD,CAAZ;AACD,GANU,CAAX;AAOD;SAEeI,iBAAiBC;AAC/B,MAAIC,YAAY,GAAGb,eAAe,EAAlC;;AAEA,WAASI,MAAT;sCAAmBU;AAAAA,MAAAA;;;AACjB;AACAF,IAAAA,QAAQ,QAAR,YAAAA,QAAQ,MAAR,SAAcE,IAAd;;AAGAD,IAAAA,YAAY,MAAZ,SAAgBC,IAAhB;AACD;;AAEDC,EAAAA,OAAO,CAAClB,YAAD,EAAeO,MAAf,CAAP;AACD;;;;"}