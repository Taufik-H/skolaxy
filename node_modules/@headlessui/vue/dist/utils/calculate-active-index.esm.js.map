{"version":3,"file":"calculate-active-index.esm.js","sources":["../../src/utils/calculate-active-index.ts"],"sourcesContent":["function assertNever(x: never): never {\n  throw new Error('Unexpected object: ' + x)\n}\n\nexport enum Focus {\n  /** Focus the first non-disabled item. */\n  First,\n\n  /** Focus the previous non-disabled item. */\n  Previous,\n\n  /** Focus the next non-disabled item. */\n  Next,\n\n  /** Focus the last non-disabled item. */\n  Last,\n\n  /** Focus a specific item based on the `id` of the item. */\n  Specific,\n\n  /** Focus no items at all. */\n  Nothing,\n}\n\nexport function calculateActiveIndex<TItem>(\n  action: { focus: Focus.Specific; id: string } | { focus: Exclude<Focus, Focus.Specific> },\n  resolvers: {\n    resolveItems(): TItem[]\n    resolveActiveIndex(): number | null\n    resolveId(item: TItem): string\n    resolveDisabled(item: TItem): boolean\n  }\n) {\n  let items = resolvers.resolveItems()\n  if (items.length <= 0) return null\n\n  let currentActiveIndex = resolvers.resolveActiveIndex()\n  let activeIndex = currentActiveIndex ?? -1\n\n  let nextActiveIndex = (() => {\n    switch (action.focus) {\n      case Focus.First:\n        return items.findIndex(item => !resolvers.resolveDisabled(item))\n\n      case Focus.Previous: {\n        let idx = items\n          .slice()\n          .reverse()\n          .findIndex((item, idx, all) => {\n            if (activeIndex !== -1 && all.length - idx - 1 >= activeIndex) return false\n            return !resolvers.resolveDisabled(item)\n          })\n        if (idx === -1) return idx\n        return items.length - 1 - idx\n      }\n\n      case Focus.Next:\n        return items.findIndex((item, idx) => {\n          if (idx <= activeIndex) return false\n          return !resolvers.resolveDisabled(item)\n        })\n\n      case Focus.Last: {\n        let idx = items\n          .slice()\n          .reverse()\n          .findIndex(item => !resolvers.resolveDisabled(item))\n        if (idx === -1) return idx\n        return items.length - 1 - idx\n      }\n\n      case Focus.Specific:\n        return items.findIndex(item => resolvers.resolveId(item) === action.id)\n\n      case Focus.Nothing:\n        return null\n\n      default:\n        assertNever(action)\n    }\n  })()\n\n  return nextActiveIndex === -1 ? currentActiveIndex : nextActiveIndex\n}\n"],"names":["assertNever","x","Error","Focus","calculateActiveIndex","action","resolvers","items","resolveItems","length","currentActiveIndex","resolveActiveIndex","activeIndex","nextActiveIndex","focus","First","findIndex","item","resolveDisabled","Previous","idx","slice","reverse","all","Next","Last","Specific","resolveId","id","Nothing"],"mappings":"AAAA,SAASA,WAAT,CAAqBC,CAArB;AACE,QAAM,IAAIC,KAAJ,CAAU,wBAAwBD,CAAlC,CAAN;AACD;;IAEWE;;AAAZ,WAAYA;AACV;AACAA,EAAAA,yBAAA,UAAA;AAEA;;AACAA,EAAAA,4BAAA,aAAA;AAEA;;AACAA,EAAAA,wBAAA,SAAA;AAEA;;AACAA,EAAAA,wBAAA,SAAA;AAEA;;AACAA,EAAAA,4BAAA,aAAA;AAEA;;AACAA,EAAAA,2BAAA,YAAA;AACD,CAlBD,EAAYA,KAAK,KAALA,KAAK,KAAA,CAAjB;;SAoBgBC,qBACdC,QACAC;AAOA,MAAIC,KAAK,GAAGD,SAAS,CAACE,YAAV,EAAZ;AACA,MAAID,KAAK,CAACE,MAAN,IAAgB,CAApB,EAAuB,OAAO,IAAP;AAEvB,MAAIC,kBAAkB,GAAGJ,SAAS,CAACK,kBAAV,EAAzB;AACA,MAAIC,WAAW,GAAGF,kBAAH,WAAGA,kBAAH,GAAyB,CAAC,CAAzC;;AAEA,MAAIG,eAAe,GAAI;AACrB,YAAQR,MAAM,CAACS,KAAf;AACE,WAAKX,KAAK,CAACY,KAAX;AACE,eAAOR,KAAK,CAACS,SAAN,CAAgB,UAAAC,IAAI;AAAA,iBAAI,CAACX,SAAS,CAACY,eAAV,CAA0BD,IAA1B,CAAL;AAAA,SAApB,CAAP;;AAEF,WAAKd,KAAK,CAACgB,QAAX;AAAqB;AACnB,cAAIC,GAAG,GAAGb,KAAK,CACZc,KADO,GAEPC,OAFO,GAGPN,SAHO,CAGG,UAACC,IAAD,EAAOG,GAAP,EAAYG,GAAZ;AACT,gBAAIX,WAAW,KAAK,CAAC,CAAjB,IAAsBW,GAAG,CAACd,MAAJ,GAAaW,GAAb,GAAmB,CAAnB,IAAwBR,WAAlD,EAA+D,OAAO,KAAP;AAC/D,mBAAO,CAACN,SAAS,CAACY,eAAV,CAA0BD,IAA1B,CAAR;AACD,WANO,CAAV;AAOA,cAAIG,GAAG,KAAK,CAAC,CAAb,EAAgB,OAAOA,GAAP;AAChB,iBAAOb,KAAK,CAACE,MAAN,GAAe,CAAf,GAAmBW,GAA1B;AACD;;AAED,WAAKjB,KAAK,CAACqB,IAAX;AACE,eAAOjB,KAAK,CAACS,SAAN,CAAgB,UAACC,IAAD,EAAOG,GAAP;AACrB,cAAIA,GAAG,IAAIR,WAAX,EAAwB,OAAO,KAAP;AACxB,iBAAO,CAACN,SAAS,CAACY,eAAV,CAA0BD,IAA1B,CAAR;AACD,SAHM,CAAP;;AAKF,WAAKd,KAAK,CAACsB,IAAX;AAAiB;AACf,cAAIL,IAAG,GAAGb,KAAK,CACZc,KADO,GAEPC,OAFO,GAGPN,SAHO,CAGG,UAAAC,IAAI;AAAA,mBAAI,CAACX,SAAS,CAACY,eAAV,CAA0BD,IAA1B,CAAL;AAAA,WAHP,CAAV;;AAIA,cAAIG,IAAG,KAAK,CAAC,CAAb,EAAgB,OAAOA,IAAP;AAChB,iBAAOb,KAAK,CAACE,MAAN,GAAe,CAAf,GAAmBW,IAA1B;AACD;;AAED,WAAKjB,KAAK,CAACuB,QAAX;AACE,eAAOnB,KAAK,CAACS,SAAN,CAAgB,UAAAC,IAAI;AAAA,iBAAIX,SAAS,CAACqB,SAAV,CAAoBV,IAApB,MAA8BZ,MAAM,CAACuB,EAAzC;AAAA,SAApB,CAAP;;AAEF,WAAKzB,KAAK,CAAC0B,OAAX;AACE,eAAO,IAAP;;AAEF;AACE7B,QAAAA,WAAW,CAACK,MAAD,CAAX;AAtCJ;AAwCD,GAzCqB,EAAtB;;AA2CA,SAAOQ,eAAe,KAAK,CAAC,CAArB,GAAyBH,kBAAzB,GAA8CG,eAArD;AACD;;;;"}