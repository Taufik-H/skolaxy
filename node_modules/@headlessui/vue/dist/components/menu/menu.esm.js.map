{"version":3,"file":"menu.esm.js","sources":["../../../src/components/menu/menu.ts"],"sourcesContent":["import {\n  defineComponent,\n  ref,\n  provide,\n  inject,\n  onMounted,\n  onUnmounted,\n  computed,\n  nextTick,\n  InjectionKey,\n  Ref,\n  watchEffect,\n} from 'vue'\nimport { Features, render } from '../../utils/render'\nimport { useId } from '../../hooks/use-id'\nimport { Keys } from '../../keyboard'\nimport { Focus, calculateActiveIndex } from '../../utils/calculate-active-index'\nimport { dom } from '../../utils/dom'\nimport { useWindowEvent } from '../../hooks/use-window-event'\nimport { useTreeWalker } from '../../hooks/use-tree-walker'\nimport { useOpenClosedProvider, State, useOpenClosed } from '../../internal/open-closed'\nimport { match } from '../../utils/match'\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type'\n\nenum MenuStates {\n  Open,\n  Closed,\n}\n\nfunction nextFrame(cb: () => void) {\n  requestAnimationFrame(() => requestAnimationFrame(cb))\n}\n\ntype MenuItemDataRef = Ref<{ textValue: string; disabled: boolean }>\ntype StateDefinition = {\n  // State\n  menuState: Ref<MenuStates>\n  buttonRef: Ref<HTMLButtonElement | null>\n  itemsRef: Ref<HTMLDivElement | null>\n  items: Ref<{ id: string; dataRef: MenuItemDataRef }[]>\n  searchQuery: Ref<string>\n  activeItemIndex: Ref<number | null>\n\n  // State mutators\n  closeMenu(): void\n  openMenu(): void\n  goToItem(focus: Focus, id?: string): void\n  search(value: string): void\n  clearSearch(): void\n  registerItem(id: string, dataRef: MenuItemDataRef): void\n  unregisterItem(id: string): void\n}\n\nlet MenuContext = Symbol('MenuContext') as InjectionKey<StateDefinition>\n\nfunction useMenuContext(component: string) {\n  let context = inject(MenuContext, null)\n\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <Menu /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useMenuContext)\n    throw err\n  }\n\n  return context\n}\n\nexport let Menu = defineComponent({\n  name: 'Menu',\n  props: { as: { type: [Object, String], default: 'template' } },\n  setup(props, { slots, attrs }) {\n    let menuState = ref<StateDefinition['menuState']['value']>(MenuStates.Closed)\n    let buttonRef = ref<StateDefinition['buttonRef']['value']>(null)\n    let itemsRef = ref<StateDefinition['itemsRef']['value']>(null)\n    let items = ref<StateDefinition['items']['value']>([])\n    let searchQuery = ref<StateDefinition['searchQuery']['value']>('')\n    let activeItemIndex = ref<StateDefinition['activeItemIndex']['value']>(null)\n\n    let api = {\n      menuState,\n      buttonRef,\n      itemsRef,\n      items,\n      searchQuery,\n      activeItemIndex,\n      closeMenu: () => {\n        menuState.value = MenuStates.Closed\n        activeItemIndex.value = null\n      },\n      openMenu: () => (menuState.value = MenuStates.Open),\n      goToItem(focus: Focus, id?: string) {\n        let nextActiveItemIndex = calculateActiveIndex(\n          focus === Focus.Specific\n            ? { focus: Focus.Specific, id: id! }\n            : { focus: focus as Exclude<Focus, Focus.Specific> },\n          {\n            resolveItems: () => items.value,\n            resolveActiveIndex: () => activeItemIndex.value,\n            resolveId: item => item.id,\n            resolveDisabled: item => item.dataRef.disabled,\n          }\n        )\n\n        if (searchQuery.value === '' && activeItemIndex.value === nextActiveItemIndex) return\n        searchQuery.value = ''\n        activeItemIndex.value = nextActiveItemIndex\n      },\n      search(value: string) {\n        searchQuery.value += value.toLowerCase()\n\n        let match = items.value.findIndex(\n          item => item.dataRef.textValue.startsWith(searchQuery.value) && !item.dataRef.disabled\n        )\n\n        if (match === -1 || match === activeItemIndex.value) return\n\n        activeItemIndex.value = match\n      },\n      clearSearch() {\n        searchQuery.value = ''\n      },\n      registerItem(id: string, dataRef: MenuItemDataRef) {\n        // @ts-expect-error The expected type comes from property 'dataRef' which is declared here on type '{ id: string; dataRef: { textValue: string; disabled: boolean; }; }'\n        items.value.push({ id, dataRef })\n      },\n      unregisterItem(id: string) {\n        let nextItems = items.value.slice()\n        let currentActiveItem =\n          activeItemIndex.value !== null ? nextItems[activeItemIndex.value] : null\n        let idx = nextItems.findIndex(a => a.id === id)\n        if (idx !== -1) nextItems.splice(idx, 1)\n        items.value = nextItems\n        activeItemIndex.value = (() => {\n          if (idx === activeItemIndex.value) return null\n          if (currentActiveItem === null) return null\n\n          // If we removed the item before the actual active index, then it would be out of sync. To\n          // fix this, we will find the correct (new) index position.\n          return nextItems.indexOf(currentActiveItem)\n        })()\n      },\n    }\n\n    useWindowEvent('mousedown', event => {\n      let target = event.target as HTMLElement\n      let active = document.activeElement\n\n      if (menuState.value !== MenuStates.Open) return\n      if (dom(buttonRef)?.contains(target)) return\n\n      if (!dom(itemsRef)?.contains(target)) api.closeMenu()\n      if (active !== document.body && active?.contains(target)) return // Keep focus on newly clicked/focused element\n      if (!event.defaultPrevented) dom(buttonRef)?.focus({ preventScroll: true })\n    })\n\n    // @ts-expect-error Types of property 'dataRef' are incompatible.\n    provide(MenuContext, api)\n    useOpenClosedProvider(\n      computed(() =>\n        match(menuState.value, {\n          [MenuStates.Open]: State.Open,\n          [MenuStates.Closed]: State.Closed,\n        })\n      )\n    )\n\n    return () => {\n      let slot = { open: menuState.value === MenuStates.Open }\n      return render({ props, slot, slots, attrs, name: 'Menu' })\n    }\n  },\n})\n\nexport let MenuButton = defineComponent({\n  name: 'MenuButton',\n  props: {\n    disabled: { type: Boolean, default: false },\n    as: { type: [Object, String], default: 'button' },\n  },\n  render() {\n    let api = useMenuContext('MenuButton')\n\n    let slot = { open: api.menuState.value === MenuStates.Open }\n    let propsWeControl = {\n      ref: 'el',\n      id: this.id,\n      type: this.type,\n      'aria-haspopup': true,\n      'aria-controls': dom(api.itemsRef)?.id,\n      'aria-expanded': this.$props.disabled ? undefined : api.menuState.value === MenuStates.Open,\n      onKeydown: this.handleKeyDown,\n      onKeyup: this.handleKeyUp,\n      onClick: this.handleClick,\n    }\n\n    return render({\n      props: { ...this.$props, ...propsWeControl },\n      slot,\n      attrs: this.$attrs,\n      slots: this.$slots,\n      name: 'MenuButton',\n    })\n  },\n  setup(props, { attrs }) {\n    let api = useMenuContext('MenuButton')\n    let id = `headlessui-menu-button-${useId()}`\n\n    function handleKeyDown(event: KeyboardEvent) {\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-13\n\n        case Keys.Space:\n        case Keys.Enter:\n        case Keys.ArrowDown:\n          event.preventDefault()\n          event.stopPropagation()\n          api.openMenu()\n          nextTick(() => {\n            dom(api.itemsRef)?.focus({ preventScroll: true })\n            api.goToItem(Focus.First)\n          })\n          break\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          event.stopPropagation()\n          api.openMenu()\n          nextTick(() => {\n            dom(api.itemsRef)?.focus({ preventScroll: true })\n            api.goToItem(Focus.Last)\n          })\n          break\n      }\n    }\n\n    function handleKeyUp(event: KeyboardEvent) {\n      switch (event.key) {\n        case Keys.Space:\n          // Required for firefox, event.preventDefault() in handleKeyDown for\n          // the Space key doesn't cancel the handleKeyUp, which in turn\n          // triggers a *click*.\n          event.preventDefault()\n          break\n      }\n    }\n\n    function handleClick(event: MouseEvent) {\n      if (props.disabled) return\n      if (api.menuState.value === MenuStates.Open) {\n        api.closeMenu()\n        nextTick(() => dom(api.buttonRef)?.focus({ preventScroll: true }))\n      } else {\n        event.preventDefault()\n        event.stopPropagation()\n        api.openMenu()\n        nextFrame(() => dom(api.itemsRef)?.focus({ preventScroll: true }))\n      }\n    }\n\n    return {\n      id,\n      el: api.buttonRef,\n      type: useResolveButtonType(\n        computed(() => ({ as: props.as, type: attrs.type })),\n        api.buttonRef\n      ),\n      handleKeyDown,\n      handleKeyUp,\n      handleClick,\n    }\n  },\n})\n\nexport let MenuItems = defineComponent({\n  name: 'MenuItems',\n  props: {\n    as: { type: [Object, String], default: 'div' },\n    static: { type: Boolean, default: false },\n    unmount: { type: Boolean, default: true },\n  },\n  render() {\n    let api = useMenuContext('MenuItems')\n\n    let slot = { open: api.menuState.value === MenuStates.Open }\n    let propsWeControl = {\n      'aria-activedescendant':\n        api.activeItemIndex.value === null\n          ? undefined\n          : api.items.value[api.activeItemIndex.value]?.id,\n      'aria-labelledby': dom(api.buttonRef)?.id,\n      id: this.id,\n      onKeydown: this.handleKeyDown,\n      onKeyup: this.handleKeyUp,\n      role: 'menu',\n      tabIndex: 0,\n      ref: 'el',\n    }\n    let passThroughProps = this.$props\n\n    return render({\n      props: { ...passThroughProps, ...propsWeControl },\n      slot,\n      attrs: this.$attrs,\n      slots: this.$slots,\n      features: Features.RenderStrategy | Features.Static,\n      visible: this.visible,\n      name: 'MenuItems',\n    })\n  },\n  setup() {\n    let api = useMenuContext('MenuItems')\n    let id = `headlessui-menu-items-${useId()}`\n    let searchDebounce = ref<ReturnType<typeof setTimeout> | null>(null)\n\n    useTreeWalker({\n      container: computed(() => dom(api.itemsRef)),\n      enabled: computed(() => api.menuState.value === MenuStates.Open),\n      accept(node) {\n        if (node.getAttribute('role') === 'menuitem') return NodeFilter.FILTER_REJECT\n        if (node.hasAttribute('role')) return NodeFilter.FILTER_SKIP\n        return NodeFilter.FILTER_ACCEPT\n      },\n      walk(node) {\n        node.setAttribute('role', 'none')\n      },\n    })\n\n    function handleKeyDown(event: KeyboardEvent) {\n      if (searchDebounce.value) clearTimeout(searchDebounce.value)\n\n      switch (event.key) {\n        // Ref: https://www.w3.org/TR/wai-aria-practices-1.2/#keyboard-interaction-12\n\n        // @ts-expect-error Fallthrough is expected here\n        case Keys.Space:\n          if (api.searchQuery.value !== '') {\n            event.preventDefault()\n            event.stopPropagation()\n            return api.search(event.key)\n          }\n        // When in type ahead mode, fallthrough\n        case Keys.Enter:\n          event.preventDefault()\n          event.stopPropagation()\n          if (api.activeItemIndex.value !== null) {\n            let { id } = api.items.value[api.activeItemIndex.value]\n            document.getElementById(id)?.click()\n          }\n          api.closeMenu()\n          nextTick(() => dom(api.buttonRef)?.focus({ preventScroll: true }))\n          break\n\n        case Keys.ArrowDown:\n          event.preventDefault()\n          event.stopPropagation()\n          return api.goToItem(Focus.Next)\n\n        case Keys.ArrowUp:\n          event.preventDefault()\n          event.stopPropagation()\n          return api.goToItem(Focus.Previous)\n\n        case Keys.Home:\n        case Keys.PageUp:\n          event.preventDefault()\n          event.stopPropagation()\n          return api.goToItem(Focus.First)\n\n        case Keys.End:\n        case Keys.PageDown:\n          event.preventDefault()\n          event.stopPropagation()\n          return api.goToItem(Focus.Last)\n\n        case Keys.Escape:\n          event.preventDefault()\n          event.stopPropagation()\n          api.closeMenu()\n          nextTick(() => dom(api.buttonRef)?.focus({ preventScroll: true }))\n          break\n\n        case Keys.Tab:\n          event.preventDefault()\n          event.stopPropagation()\n          break\n\n        default:\n          if (event.key.length === 1) {\n            api.search(event.key)\n            searchDebounce.value = setTimeout(() => api.clearSearch(), 350)\n          }\n          break\n      }\n    }\n\n    function handleKeyUp(event: KeyboardEvent) {\n      switch (event.key) {\n        case Keys.Space:\n          // Required for firefox, event.preventDefault() in handleKeyDown for\n          // the Space key doesn't cancel the handleKeyUp, which in turn\n          // triggers a *click*.\n          event.preventDefault()\n          break\n      }\n    }\n\n    let usesOpenClosedState = useOpenClosed()\n    let visible = computed(() => {\n      if (usesOpenClosedState !== null) {\n        return usesOpenClosedState.value === State.Open\n      }\n\n      return api.menuState.value === MenuStates.Open\n    })\n\n    return { id, el: api.itemsRef, handleKeyDown, handleKeyUp, visible }\n  },\n})\n\nexport let MenuItem = defineComponent({\n  name: 'MenuItem',\n  props: {\n    as: { type: [Object, String], default: 'template' },\n    disabled: { type: Boolean, default: false },\n  },\n  setup(props, { slots, attrs }) {\n    let api = useMenuContext('MenuItem')\n    let id = `headlessui-menu-item-${useId()}`\n\n    let active = computed(() => {\n      return api.activeItemIndex.value !== null\n        ? api.items.value[api.activeItemIndex.value].id === id\n        : false\n    })\n\n    let dataRef = ref<MenuItemDataRef['value']>({ disabled: props.disabled, textValue: '' })\n    onMounted(() => {\n      let textValue = document\n        .getElementById(id)\n        ?.textContent?.toLowerCase()\n        .trim()\n      if (textValue !== undefined) dataRef.value.textValue = textValue\n    })\n\n    onMounted(() => api.registerItem(id, dataRef))\n    onUnmounted(() => api.unregisterItem(id))\n\n    watchEffect(() => {\n      if (api.menuState.value !== MenuStates.Open) return\n      if (!active.value) return\n      nextTick(() => document.getElementById(id)?.scrollIntoView?.({ block: 'nearest' }))\n    })\n\n    function handleClick(event: MouseEvent) {\n      if (props.disabled) return event.preventDefault()\n      api.closeMenu()\n      nextTick(() => dom(api.buttonRef)?.focus({ preventScroll: true }))\n    }\n\n    function handleFocus() {\n      if (props.disabled) return api.goToItem(Focus.Nothing)\n      api.goToItem(Focus.Specific, id)\n    }\n\n    function handleMove() {\n      if (props.disabled) return\n      if (active.value) return\n      api.goToItem(Focus.Specific, id)\n    }\n\n    function handleLeave() {\n      if (props.disabled) return\n      if (!active.value) return\n      api.goToItem(Focus.Nothing)\n    }\n\n    return () => {\n      let { disabled } = props\n      let slot = { active: active.value, disabled }\n      let propsWeControl = {\n        id,\n        role: 'menuitem',\n        tabIndex: disabled === true ? undefined : -1,\n        'aria-disabled': disabled === true ? true : undefined,\n        onClick: handleClick,\n        onFocus: handleFocus,\n        onPointermove: handleMove,\n        onMousemove: handleMove,\n        onPointerleave: handleLeave,\n        onMouseleave: handleLeave,\n      }\n\n      return render({\n        props: { ...props, ...propsWeControl },\n        slot,\n        attrs,\n        slots,\n        name: 'MenuItem',\n      })\n    }\n  },\n})\n"],"names":["MenuStates","nextFrame","cb","requestAnimationFrame","MenuContext","Symbol","useMenuContext","component","context","inject","err","Error","captureStackTrace","Menu","defineComponent","name","props","as","type","Object","String","setup","slots","attrs","menuState","ref","Closed","buttonRef","itemsRef","items","searchQuery","activeItemIndex","api","closeMenu","value","openMenu","Open","goToItem","focus","id","nextActiveItemIndex","calculateActiveIndex","Focus","Specific","resolveItems","resolveActiveIndex","resolveId","item","resolveDisabled","dataRef","disabled","search","toLowerCase","match","findIndex","textValue","startsWith","clearSearch","registerItem","push","unregisterItem","nextItems","slice","currentActiveItem","idx","a","splice","indexOf","useWindowEvent","event","target","active","document","activeElement","dom","contains","body","defaultPrevented","preventScroll","provide","useOpenClosedProvider","computed","State","slot","open","render","MenuButton","Boolean","propsWeControl","$props","undefined","onKeydown","handleKeyDown","onKeyup","handleKeyUp","onClick","handleClick","$attrs","$slots","useId","key","Keys","Space","Enter","ArrowDown","preventDefault","stopPropagation","nextTick","First","ArrowUp","Last","el","useResolveButtonType","MenuItems","unmount","role","tabIndex","passThroughProps","features","Features","RenderStrategy","Static","visible","searchDebounce","useTreeWalker","container","enabled","accept","node","getAttribute","NodeFilter","FILTER_REJECT","hasAttribute","FILTER_SKIP","FILTER_ACCEPT","walk","setAttribute","clearTimeout","getElementById","click","Next","Previous","Home","PageUp","End","PageDown","Escape","Tab","length","setTimeout","usesOpenClosedState","useOpenClosed","MenuItem","onMounted","textContent","trim","onUnmounted","watchEffect","scrollIntoView","block","handleFocus","Nothing","handleMove","handleLeave","onFocus","onPointermove","onMousemove","onPointerleave","onMouseleave"],"mappings":"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"}