{"version":3,"file":"label.esm.js","sources":["../../../src/components/label/label.ts"],"sourcesContent":["import {\n  computed,\n  defineComponent,\n  inject,\n  onMounted,\n  onUnmounted,\n  provide,\n  ref,\n  unref,\n\n  // Types\n  ComputedRef,\n  InjectionKey,\n} from 'vue'\n\nimport { useId } from '../../hooks/use-id'\nimport { render } from '../../utils/render'\n\n// ---\n\nlet LabelContext = Symbol('LabelContext') as InjectionKey<{\n  register(value: string): () => void\n  slot: Record<string, unknown>\n  name: string\n  props: Record<string, unknown>\n}>\n\nfunction useLabelContext() {\n  let context = inject(LabelContext, null)\n  if (context === null) {\n    let err = new Error('You used a <Label /> component, but it is not inside a parent.')\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useLabelContext)\n    throw err\n  }\n  return context\n}\n\nexport function useLabels({\n  slot = {},\n  name = 'Label',\n  props = {},\n}: {\n  slot?: Record<string, unknown>\n  name?: string\n  props?: Record<string, unknown>\n} = {}): ComputedRef<string | undefined> {\n  let labelIds = ref<string[]>([])\n  function register(value: string) {\n    labelIds.value.push(value)\n\n    return () => {\n      let idx = labelIds.value.indexOf(value)\n      if (idx === -1) return\n      labelIds.value.splice(idx, 1)\n    }\n  }\n\n  provide(LabelContext, { register, slot, name, props })\n\n  // The actual id's as string or undefined.\n  return computed(() => (labelIds.value.length > 0 ? labelIds.value.join(' ') : undefined))\n}\n\n// ---\n\nexport let Label = defineComponent({\n  name: 'Label',\n  props: {\n    as: { type: [Object, String], default: 'label' },\n    passive: { type: [Boolean], default: false },\n  },\n  render() {\n    let { name = 'Label', slot = {}, props = {} } = this.context\n    let { passive, ...passThroughProps } = this.$props\n    let propsWeControl = {\n      ...Object.entries(props).reduce(\n        (acc, [key, value]) => Object.assign(acc, { [key]: unref(value) }),\n        {}\n      ),\n      id: this.id,\n    }\n    let allProps = { ...passThroughProps, ...propsWeControl }\n\n    // @ts-expect-error props are dynamic via context, some components will\n    //                  provide an onClick then we can delete it.\n    if (passive) delete allProps['onClick']\n\n    return render({\n      props: allProps,\n      slot,\n      attrs: this.$attrs,\n      slots: this.$slots,\n      name,\n    })\n  },\n  setup() {\n    let context = useLabelContext()\n    let id = `headlessui-label-${useId()}`\n\n    onMounted(() => onUnmounted(context.register(id)))\n\n    return { id, context }\n  },\n})\n"],"names":["LabelContext","Symbol","useLabelContext","context","inject","err","Error","captureStackTrace","useLabels","slot","name","props","labelIds","ref","register","value","push","idx","indexOf","splice","provide","computed","length","join","undefined","Label","defineComponent","as","type","Object","String","passive","Boolean","render","$props","passThroughProps","propsWeControl","entries","reduce","acc","key","assign","unref","id","allProps","attrs","$attrs","slots","$slots","setup","useId","onMounted","onUnmounted"],"mappings":"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"}